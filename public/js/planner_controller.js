const trainData = {
    "Ht-Ut": [
        [[0,3],[0,48],'4a','21','sp'],
        [[5,33],[6,18],'7a','20','sp'],
        [[5,53],[6,21],'4b','7','ic'],
        [[6,8],[6,35],'4a','7','ic'],
        [[6,23],[6,51],'4b','7','ic'],
        [[6,38],[7,5],'3a','7','ic'],
        [[6,48],[7,15],'3a','7','ic'],
        [[6,58],[7,27],'3','7','ic'],
        [[7,8],[7,35],'4a','7','ic'],
        [[7,23],[7,51],'4b','7','ic'],
        [[7,38],[8,5],'3a','7','ic'],
        [[7,48],[8,15],'3a','7','ic'],
        [[7,58],[8,27],'3','7','ic'],
        [[8,8],[8,35],'4a','7','ic'],
        [[8,23],[8,51],'4b','7','ic'],
        [[8,38],[9,5],'3a','7','ic'],
        [[8,48],[9,15],'3a','7','ic'],
        [[8,58],[9,27],'3','7','ic'],
        [[9,8],[9,35],'4a','7','ic'],
        [[9,23],[9,51],'4b','7','ic'],
        [[9,38],[10,5],'3a','7','ic'],
        [[9,48],[10,15],'3a','7','ic'],
        [[9,58],[10,27],'3','7','ic'],
        [[10,8],[10,35],'4a','7','ic'],
        [[10,23],[10,51],'4b','7','ic'],
        [[10,38],[11,5],'3a','7','ic'],
        [[10,48],[11,15],'3a','7','ic'],
        [[10,58],[11,27],'3','7','ic'],
        [[11,8],[11,35],'4a','7','ic'],
        [[11,23],[11,51],'4b','7','ic'],
        [[11,38],[12,5],'3a','7','ic'],
        [[11,48],[12,15],'3a','7','ic'],
        [[11,58],[12,27],'3','7','ic'],
        [[12,8],[12,35],'4a','7','ic'],
        [[12,23],[12,51],'4b','7','ic'],
        [[12,38],[13,5],'3a','7','ic'],
        [[12,48],[13,15],'3a','7','ic'],
        [[12,58],[13,27],'3','7','ic'],
        [[13,8],[13,35],'4a','7','ic'],
        [[13,23],[13,51],'4b','7','ic'],
        [[13,38],[14,5],'3a','7','ic'],
        [[13,48],[14,15],'3a','7','ic'],
        [[13,58],[14,27],'3','7','ic'],
        [[14,8],[14,35],'4a','7','ic'],
        [[14,23],[14,51],'4b','7','ic'],
        [[14,38],[15,5],'3a','7','ic'],
        [[14,48],[15,15],'3a','7','ic'],
        [[14,58],[15,27],'3','7','ic'],
        [[15,8],[15,35],'4a','7','ic'],
        [[15,23],[15,51],'4b','7','ic'],
        [[15,38],[16,5],'3a','7','ic'],
        [[15,48],[16,15],'3a','7','ic'],
        [[15,58],[16,27],'3','7','ic'],
        [[16,8],[16,35],'4a','7','ic'],
        [[16,23],[16,51],'4b','7','ic'],
        [[16,38],[17,5],'3a','7','ic'],
        [[16,48],[17,15],'3a','7','ic'],
        [[16,58],[17,27],'3','7','ic'],
        [[17,8],[17,35],'4a','7','ic'],
        [[17,23],[17,51],'4b','7','ic'],
        [[17,38],[18,5],'3a','7','ic'],
        [[17,48],[18,15],'3a','7','ic'],
        [[17,58],[18,27],'3','7','ic'],
        [[18,8],[18,35],'4a','7','ic'],
        [[18,23],[18,51],'4b','7','ic'],
        [[18,38],[19,5],'3a','7','ic'],
        [[18,48],[19,15],'3a','7','ic'],
        [[18,58],[19,27],'3','7','ic'],
        [[19,8],[19,35],'4a','7','ic'],
        [[19,23],[19,51],'4b','7','ic'],
        [[19,38],[20,5],'3a','7','ic'],
        [[19,48],[20,15],'3a','7','ic'],
        [[19,58],[20,27],'3','7','ic'],
        [[20,8],[20,35],'4a','7','ic'],
        [[20,23],[20,51],'4b','7','ic'],
        [[20,38],[21,5],'3a','7','ic'],
        [[20,48],[21,15],'3a','7','ic'],
        [[20,58],[21,27],'3','7','ic'],
        [[21,8],[21,35],'4a','7','ic'],
        [[21,23],[21,51],'4b','7','ic'],
        [[21,38],[22,5],'3a','7','ic'],
        [[21,48],[22,15],'3a','7','ic'],
        [[21,58],[22,27],'3','7','ic'],
        [[22,3],[22,48],'4a','20','sp'],
        [[22,23],[22,51],'4b','7','ic'],
        [[22,33],[23,5],'4a','20','sp'],
        [[22,48],[23,15],'3a','7','ic'],
        [[22,58],[23,27],'3','7','ic'],
        [[23,3],[23,48],'4a','20','ic'],
        [[23,23],[23,51],'4b','7','ic']
    ],
    "Ut-Amf": [
        [[0,7],[0,20],'12','2','ic'],
        [[0,19],[0,32],'12','2','ic'],
        [[0,37],[0,50],'12','2','ic'],
        [[0,49],[1,2],'12','2','ic'],
        [[5,51],[6,10],'4','1','sp'],
        [[6,7],[6,20],'12','2','ic'],
        [[6,19],[6,32],'12','2','ic'],
        [[6,21],[6,40],'4','1','sp'],
        [[6,37],[6,50],'12','2','ic'],
        [[6,49],[7,2],'12','2','ic'],
        [[6,51],[7,10],'4','1','sp'],
        [[7,7],[7,20],'12','2','ic'],
        [[7,19],[7,32],'12','2','ic'],
        [[7,21],[7,40],'4','1','sp'],
        [[7,37],[7,50],'12','2','ic'],
        [[7,49],[8,2],'12','2','ic'],
        [[7,51],[8,10],'4','1','sp'],
        [[8,7],[8,20],'12','2','ic'],
        [[8,19],[8,32],'12','2','ic'],
        [[8,21],[8,40],'4','1','sp'],
        [[8,37],[8,50],'12','2','ic'],
        [[8,49],[9,2],'12','2','ic'],
        [[8,51],[9,10],'4','1','sp'],
        [[9,7],[9,20],'12','2','ic'],
        [[9,19],[9,32],'12','2','ic'],
        [[9,21],[9,40],'4','1','sp'],
        [[9,37],[9,50],'12','2','ic'],
        [[9,49],[10,2],'12','2','ic'],
        [[9,51],[10,10],'4','1','sp'],
        [[10,7],[10,20],'12','2','ic'],
        [[10,19],[10,32],'12','2','ic'],
        [[10,21],[10,40],'4','1','sp'],
        [[10,37],[10,50],'12','2','ic'],
        [[10,49],[11,2],'12','2','ic'],
        [[10,51],[11,10],'4','1','sp'],
        [[11,7],[11,20],'12','2','ic'],
        [[11,19],[11,32],'12','2','ic'],
        [[11,21],[11,40],'4','1','sp'],
        [[11,37],[11,50],'12','2','ic'],
        [[11,49],[12,2],'12','2','ic'],
        [[11,51],[12,10],'4','1','sp'],
        [[12,7],[12,20],'12','2','ic'],
        [[12,19],[12,32],'12','2','ic'],
        [[12,21],[12,40],'4','1','sp'],
        [[12,37],[12,50],'12','2','ic'],
        [[12,49],[13,2],'12','2','ic'],
        [[12,51],[13,10],'4','1','sp'],
        [[13,7],[13,20],'12','2','ic'],
        [[13,19],[13,32],'12','2','ic'],
        [[13,21],[13,40],'4','1','sp'],
        [[13,37],[13,50],'12','2','ic'],
        [[13,49],[14,2],'12','2','ic'],
        [[13,51],[14,10],'4','1','sp'],
        [[14,7],[14,20],'12','2','ic'],
        [[14,19],[14,32],'12','2','ic'],
        [[14,21],[14,40],'4','1','sp'],
        [[14,37],[14,50],'12','2','ic'],
        [[14,49],[15,2],'12','2','ic'],
        [[14,51],[15,10],'4','1','sp'],
        [[15,7],[15,20],'12','2','ic'],
        [[15,19],[15,32],'12','2','ic'],
        [[15,21],[15,40],'4','1','sp'],
        [[15,37],[15,50],'12','2','ic'],
        [[15,49],[16,2],'12','2','ic'],
        [[15,51],[16,10],'4','1','sp'],
        [[16,7],[16,20],'12','2','ic'],
        [[16,19],[16,32],'12','2','ic'],
        [[16,21],[16,40],'4','1','sp'],
        [[16,37],[16,50],'12','2','ic'],
        [[16,49],[17,2],'12','2','ic'],
        [[16,51],[17,10],'4','1','sp'],
        [[17,7],[17,20],'12','2','ic'],
        [[17,19],[17,32],'12','2','ic'],
        [[17,21],[17,40],'4','1','sp'],
        [[17,37],[17,50],'12','2','ic'],
        [[17,49],[18,2],'12','2','ic'],
        [[17,51],[18,10],'4','1','sp'],
        [[18,7],[18,20],'12','2','ic'],
        [[18,19],[18,32],'12','2','ic'],
        [[18,21],[18,40],'4','1','sp'],
        [[18,37],[18,50],'12','2','ic'],
        [[18,49],[19,2],'12','2','ic'],
        [[18,51],[19,10],'4','1','sp'],
        [[19,7],[19,20],'12','2','ic'],
        [[19,19],[19,32],'12','2','ic'],
        [[19,21],[19,40],'4','1','sp'],
        [[19,37],[19,50],'12','2','ic'],
        [[19,49],[20,2],'12','2','ic'],
        [[19,51],[20,10],'4','1','sp'],
        [[20,7],[20,20],'12','2','ic'],
        [[20,19],[20,32],'12','2','ic'],
        [[20,21],[20,40],'4','1','sp'],
        [[20,37],[20,50],'12','2','ic'],
        [[20,49],[21,2],'12','2','ic'],
        [[20,51],[21,10],'4','1','sp'],
        [[21,7],[21,20],'12','2','ic'],
        [[21,19],[21,32],'12','2','ic'],
        [[21,21],[21,40],'4','1','sp'],
        [[21,37],[21,50],'12','2','ic'],
        [[21,49],[22,2],'12','2','ic'],
        [[21,51],[22,10],'4','1','sp'],
        [[22,7],[22,20],'12','2','ic'],
        [[22,19],[22,32],'12','2','ic'],
        [[22,21],[22,40],'4','1','sp'],
        [[22,37],[22,50],'12','2','ic'],
        [[22,49],[23,2],'12','2','ic'],
        [[22,51],[23,10],'4','1','sp'],
        [[23,7],[23,20],'12','2','ic'],
        [[23,19],[23,32],'12','2','ic'],
        [[23,21],[23,40],'4','1','sp'],
        [[23,37],[23,50],'12','2','ic'],
        [[23,49],[0,2],'12','2','ic'],
        [[23,51],[0,10],'4','1','sp'],
    ]
};

var currentDate = new Date();

var htUtDepTimes = [];
var htUtArrTimes = [];
trainData['Ht-Ut'].forEach(i => {
    let depTime = new Date(currentDate.getFullYear(), currentDate.getMonth(), currentDate.getDate(), i[0][0], i[0][1], 0);
    let arrTime = new Date(currentDate.getFullYear(), currentDate.getMonth(), currentDate.getDate(), i[1][0], i[1][1], 0);

    htUtDepTimes.push(depTime);
    htUtArrTimes.push(arrTime);
});

var utAmfDepTimes = [];
var utAmfArrTimes = [];
trainData['Ut-Amf'].forEach(i => {
    let depTime = new Date(currentDate.getFullYear(), currentDate.getMonth(), currentDate.getDate(), i[0][0], i[0][1], 0);
    let arrTime = new Date(currentDate.getFullYear(), currentDate.getMonth(), currentDate.getDate(), i[1][0], i[1][1], 0);

    utAmfDepTimes.push(depTime);
    utAmfArrTimes.push(arrTime);
});

var form = document.getElementById('form');
var inFromStation = document.getElementById('from');
var inTime = document.getElementById('time');
var inToStation = document.getElementById('to');
var inFromTo = document.getElementById('fromto');
var inTransferTime = document.getElementById('transfertime');
var inputs = document.querySelector('.input');
var times = document.querySelector('.time');
var outputtext = document.querySelector('.outputtext');

var fromStation = inFromStation.value;
var time = inTime.value;
var toStation = inToStation.value;
var fromTo = inFromTo.value;
var transferTime = inTransferTime.value;

function update(e) {
    if (fromStation != '' &&
        time != '' &&
        toStation != '' &&
        fromTo != '' &&
        transferTime != '' &&
        times.checkValidity()) {

        let selectedTime = new Date(currentDate.getFullYear(), currentDate.getMonth(), currentDate.getDate(), time.substr(0, 2), time.substr(3, 2));
        if (fromStation == 'Ht' && toStation == 'Amf') {
            if (fromTo == 'from') {
                let fromTime = htUtDepTimes.find((e) => (Date.parse(e) >= Date.parse(selectedTime)));
                let fromIndex = htUtDepTimes.findIndex((e) => (Date.parse(e) >= Date.parse(selectedTime)));

                let relevantTrainData = trainData['Ht-Ut'][fromIndex];

                let utArrTime = htUtArrTimes[fromIndex];

                let utTransferTime = new Date(Date.parse(utArrTime) + transferTime*60000);
                let utDepTime = utAmfDepTimes.find((e) => (Date.parse(e) >= Date.parse(utTransferTime)));
                let utDepIndex = utAmfDepTimes.findIndex((e) => (Date.parse(e) >= Date.parse(utTransferTime)));

                let amfArrTime = utAmfArrTimes[utDepIndex];

                outputtext.innerHTML = fromTime.getHours().toString().padStart(2, '0') + ':' + fromTime.getMinutes().toString().padStart(2, '0') + ' Den Bosch Centraal perron ' + relevantTrainData[2] + '<br />' +
                    ((relevantTrainData[4] == 'sp') ? 'sprinter' : 'intercity') + '<br />' +
                    utArrTime.getHours().toString().padStart(2, '0') + ':' + utArrTime.getMinutes().toString().padStart(2, '0') + ' Utrecht Centraal perron ' + relevantTrainData[3] + '<br /><br />' +
                    'overstaptijd ' + transferTime + ' minuten <br /><br />';

                relevantTrainData = trainData['Ut-Amf'][utDepIndex];

                outputtext.innerHTML += utDepTime.getHours().toString().padStart(2, '0') + ':' + utDepTime.getMinutes().toString().padStart(2, '0') + ' Utrecht Centraal perron ' + relevantTrainData[2] + '<br />' +
                    ((relevantTrainData[4] == 'sp') ? 'sprinter' : 'intercity') + '<br />' +
                    amfArrTime.getHours().toString().padStart(2, '0') + ':' + amfArrTime.getMinutes().toString().padStart(2, '0') + ' Amersfoort Centraal perron ' + relevantTrainData[3] + '<br /><br />';

            }
        }
        else {
            outputtext.innerHTML = 'deze route staat op het moment nog niet in ons systeem';
        }
    }
    else {
        outputtext.innerHTML = 'check alsjeblieft of alle velden ingevuld zijn';
    }
}

inTime.addEventListener('input', function(e) {
    time = e.target.value;

    update(e);
});

inTransferTime.addEventListener('input', function(e) {
    transferTime = e.target.value;

    update(e);
});

inFromStation.addEventListener('change', function(e) {
    fromStation = e.target.value;

    update(e);
});

inToStation.addEventListener('change', function(e) {
    toStation = e.target.value;

    update(e);
});

inFromTo.addEventListener('change', function(e) {
    fromTo = e.target.value;
});

form.addEventListener('change', function(e) {
    e.preventDefault();

    update(e);
});